!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common/http"),require("rxjs/Observable"),require("rxjs/add/operator/map"),require("rxjs/add/operator/catch")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/common/http","rxjs/Observable","rxjs/add/operator/map","rxjs/add/operator/catch"],e):e(t["ng2-hallelujah"]={},t.ng.core,t.ng.common.http,t.Rx)}(this,function(t,e,n,r){"use strict";var i=function m(){};i.decorators=[{type:e.NgModule,args:[{imports:[n.HttpClientModule],declarations:[],exports:[n.HttpClientModule],providers:[n.HttpClient]}]}],i.ctorParameters=function(){return[]};var s=function(){function t(){}return t.prototype.relatedCollection=function(t){if(this._links[t])return new f(p.stripTemplatedUrl(this._links[t].href),this.http);throw new Error("Link "+t+" does not exist!")},t.prototype.relatedEntity=function(t){if(this._links[t])return new c(p.stripTemplatedUrl(this._links[t].href),this.http);throw new Error("Link "+t+" does not exist!")},t.prototype.save=function(){if(this._links.self)return this.http.put(p.stripTemplatedUrl(this._links.self.href),p.transformForUpdate(this));throw new Error("Entity not initialised")},t.prototype.update=function(t){if(this._links.self)return this.http.patch(p.stripTemplatedUrl(this._links.self.href),p.transformForUpdate(t));throw new Error("Entity not initialised")},t}(),o=function(){function t(t,e){this.type=t,this.http=e,this.totalPages=1,this.totalItems=0,this.pageNumber=0,this.sorting=[],this.items=[]}return t.prototype.next=function(){var e=this;return this.nextUrl?this.http.get(this.nextUrl).map(function(t){return p.initPage(e.type,t,e.http)}):r.Observable["throw"]("No next page available")},t.prototype.prev=function(){var e=this;return this.prevUrl?this.http.get(this.nextUrl).map(function(t){return p.initPage(e.type,t,e.http)}):r.Observable["throw"]("No previous page available")},t.prototype.first=function(){var e=this;return this.firstUrl?this.http.get(this.nextUrl).map(function(t){return p.initPage(e.type,t,e.http)}):r.Observable["throw"]("No first page available")},t.prototype.last=function(){var e=this;return this.lastUrl?this.http.get(this.nextUrl).map(function(t){return p.initPage(e.type,t,e.http)}):r.Observable["throw"]("No last page available")},t}(),p=function(){function i(){}return i.transformForUpdate=function(t){var e={};for(var r in t)t[r]instanceof s?e[r]=i.stripTemplatedUrl(t[r]._links.self.href):"_links"!==t[r]&&(e[r]=t[r]);return e},i.initEntity=function(t,e,r){var n=new t;for(var i in e)n[i]=e[i];return n.http=r,n},i.initEntityCollection=function(e,t,r){return t._embedded[Object.keys(t._embedded)[0]].map(function(t){return i.initEntity(e,t,r)})},i.initPage=function(t,e,r){var n=new o(t,r);return n.items=i.initEntityCollection(t,e,r),n.totalItems=e.page?e.page.totalElements:n.items.length,n.totalPages=e.page?e.page.totalPages:1,n.pageNumber=e.page?e.page.number:1,n.selfUrl=e._links.self?i.stripTemplatedUrl(e._links.self.href):undefined,n.nextUrl=e._links.next?i.stripTemplatedUrl(e._links.next.href):undefined,n.prevUrl=e._links.prev?i.stripTemplatedUrl(e._links.prev.href):undefined,n.firstUrl=e._links.first?i.stripTemplatedUrl(e._links.first.href):undefined,n.lastUrl=e._links.last?i.stripTemplatedUrl(e._links.last.href):undefined,n},i.stripTemplatedUrl=function(t){return t.split("{").shift()},i.addHttpParamsToUrl=function(t,e){var r=t;return t.includes("?")||(r=r.concat("?")),r.concat(e.toString())},i}(),a=function(){function t(t,e){this.url=t,this.http=e}return t.prototype.entity=function(t){return new h(this.extendUrl(t),this.http)},t.prototype.filter=function(t){return new u(this.extendUrl(t),this.http)},t.prototype.get=function(e){var r=this;return this.http.get(this.url).map(function(t){return p.initEntityCollection(e,t,r.http)})},t.prototype.add=function(t){return this.http.post(this.url,p.transformForUpdate(t))},t.prototype.remove=function(t){return t._links.self?this.http["delete"](t._links.self.href):r.Observable["throw"]("Entity not initialised")},t.prototype.paginate=function(t){return new l(this.url,t,this.http)},t.prototype.extendUrl=function(t){var e=this.url;return e.endsWith("/")||(e=e.concat("/")),t?e.concat(t):e},t}(),u=function(){function t(t,e){this.url=t,this.http=e,this.queryParams=new n.HttpParams}return t.prototype.queryParam=function(t,e){return void 0===e&&(e=!1),e&&(this.queryParams=new n.HttpParams),this.queryParams=this.queryParams.append(t.key,t.value),this},t.prototype.get=function(e){var r=this;return this.http.get(this.url,{params:this.queryParams}).map(function(t){return p.initEntityCollection(e,t,r.http)})},t.prototype.paginate=function(t){return new l(p.addHttpParamsToUrl(this.url,this.queryParams),t,this.http)},t}(),l=function(){function t(t,e,r){this.url=t,this.size=e,this.http=r,this.sorting=new n.HttpParams,this.sizeParam=new n.HttpParams,e&&(this.sizeParam=this.sizeParam.append("size",e.toString()))}return t.prototype.sort=function(t){return this.sorting=this.sorting.append(t.property,t.order),this},t.prototype.get=function(e){var r=this,t=this.size?this.sorting.append("size",this.size.toString()):this.sorting;return this.http.get(this.url,{params:t}).map(function(t){return p.initPage(e,t,r.http)})},t}(),h=function(){function t(t,e){this.url=t,this.http=e}return t.prototype.get=function(e){var r=this;return this.http.get(this.url).map(function(t){return p.initEntity(e,t,r.http)})},t}(),f=function(){function t(t,e){this.url=t,this.http=e}return t.prototype.get=function(e){var r=this;return this.http.get(this.url).map(function(t){return p.initEntityCollection(e,t,r.http)})},t.prototype.paginate=function(t){return new l(this.url,t,this.http)},t.prototype.add=function(t){return t._links.self?this.http.post(this.url,t._links.self.href,{headers:(new n.HttpHeaders).set("Content-Type","text/uri-list")}):r.Observable["throw"]("Entity not initialised")},t.prototype.set=function(t){if(t.every(function(t){return t._links.self})){var e=t.map(function(t){return t._links.self.href});return this.http.put(this.url,e.join("\n"),{headers:(new n.HttpHeaders).set("Content-Type","text/uri-list")})}return r.Observable["throw"]("Entity not initialised")},t.prototype.setNull=function(){return this.http["delete"](this.url)},t}(),c=function(){function t(t,e){this.url=t,this.http=e}return t.prototype.get=function(e){var r=this;return this.http.get(this.url).map(function(t){return p.initEntity(e,t,r.http)})},t.prototype.set=function(t){return t._links.self?this.http.put(this.url,t._links.self.href,{headers:(new n.HttpHeaders).set("Content-Type","text/uri-list")}):r.Observable["throw"]("Entity not initialised")},t.prototype.setNull=function(){return this.http["delete"](this.url)},t}(),d=new e.InjectionToken("api.uri"),y=function(){function t(t,e){this.api_url=t,this.http=e}return t.prototype.collection=function(t){return new a(this.getUrl(t),this.http)},t.prototype.entity=function(t){return new h(t,this.http)},t.prototype.getUrl=function(t){var e=this.api_url;return e.endsWith("/")||(e=e.concat("/")),t?e.concat(t):e},t}();y.decorators=[{type:e.Injectable}],y.ctorParameters=function(){return[{type:undefined,decorators:[{type:e.Inject,args:[d]}]},{type:n.HttpClient}]},t.HallelujahModule=i,t.API_URL=d,t.ApiService=y,t.Entity=s,t.EntityHelper=p,t.Page=o,t.CollectionRef=a,t.FilteredCollectionRef=u,t.PaginatedCollectionRef=l,t.EntityRef=h,t.RelatedCollectionRef=f,t.RelatedEntityRef=c,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ng2-hallelujah.umd.min.js.map
